const sets={lower:'abcdefghijklmnopqrstuvwxyz',upper:'ABCDEFGHIJKLMNOPQRSTUVWXYZ',numbers:'0123456789',symbols:'!@#$%^&*()-_=+[]{};:,.<>/?'};
export function generatePassword(length=12,opts={lower:true,upper:true,numbers:true,symbols:false}){length=Math.max(4,Math.min(256,parseInt(length)||12));let pool='';if(opts.lower)pool+=sets.lower;if(opts.upper)pool+=sets.upper;if(opts.numbers)pool+=sets.numbers;if(opts.symbols)pool+=sets.symbols;if(pool.length===0)pool=sets.lower;const required=[];if(opts.lower)required.push(randomFrom(sets.lower));if(opts.upper)required.push(randomFrom(sets.upper));if(opts.numbers)required.push(randomFrom(sets.numbers));if(opts.symbols)required.push(randomFrom(sets.symbols));const remainingLength=Math.max(0,length-required.length);let result=required.join('');for(let i=0;i<remainingLength;i++){result+=randomFrom(pool);}result=result.split('').sort(()=>Math.random()-0.5).join('');return result;}function randomFrom(s){return s[Math.floor(Math.random()*s.length)];}